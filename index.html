<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BIZARRE VIEW</title>

    <style>
      :root {
        --bg: #0b0d12;
        --fg: #e8e9ec;
        --muted: #9aa0aa;
        --accent: #5da9ff;
        --card: #151923;
        --card-soft: rgba(255, 255, 255, 0.04);
        --border: rgba(255, 255, 255, 0.08);
        --radius: 10px;
      }

      * {
        box-sizing: border-box;
        font-family:
          system-ui,
          -apple-system,
          Segoe UI,
          Roboto,
          sans-serif;
      }

      body {
        margin: 0;
        background:
          radial-gradient(1200px 600px at 20% -10%, #16203a, transparent),
          var(--bg);
        color: var(--fg);
      }

      /* ---------------- Header ---------------- */

      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 14px 20px;
        border-bottom: 1px solid var(--border);
        backdrop-filter: blur(6px);
      }

      header > div {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      header span {
        font-weight: 600;
        letter-spacing: 0.3px;
      }

      /* ---------------- Controls ---------------- */

      form {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        padding: 16px;
        background: rgba(0, 0, 0, 0.35);
        border-bottom: 1px solid var(--border);
      }

      input,
      select,
      button {
        background: var(--card);
        color: var(--fg);
        border: 1px solid var(--border);
        padding: 9px 12px;
        border-radius: var(--radius);
        font-size: 14px;
        min-height: 38px;
      }

      input::placeholder {
        color: var(--muted);
      }

      input,
      select {
        flex: 1 1 160px;
      }

      button {
        cursor: pointer;
        background: linear-gradient(135deg, var(--accent), #3b7dff);
        border: none;
        color: #02040a;
        font-weight: 600;
        padding: 0 18px;
        transition:
          transform 0.15s ease,
          filter 0.15s ease;
      }

      button:hover {
        transform: translateY(-1px);
        filter: brightness(1.1);
      }

      button.secondary {
        background: var(--card);
        color: var(--fg);
        border: 1px solid var(--border);
      }

      /* ---------------- Gallery ---------------- */

      #grid {
        padding: 18px;
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
      }

      .card {
        background:
          linear-gradient(180deg, var(--card-soft), transparent), var(--card);
        border-radius: var(--radius);
        overflow: hidden;
        display: flex;
        flex-direction: column;
        width: 160px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
        transition:
          transform 0.2s ease,
          box-shadow 0.2s ease;
      }

      .card:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.45);
      }

      .card img {
        width: 100%;
        display: block;
      }

      .card .info {
        padding: 8px 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 11px;
        color: var(--muted);
      }

      .card a {
        color: var(--accent);
        text-decoration: none;
      }

      /* ---------------- Footer ---------------- */

      footer {
        padding: 14px 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-top: 1px solid var(--border);
        background: rgba(0, 0, 0, 0.35);
      }

      footer span {
        font-size: 13px;
        color: var(--muted);
      }

      /* ---------------- Help ---------------- */

      #helpOverlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 999;
      }

      .helpModal {
        background: var(--card);
        max-width: 900px;
        max-height: 80vh;
        overflow: auto;
        padding: 20px;
        border-radius: 14px;
        position: relative;
        box-shadow: 0 40px 100px rgba(0, 0, 0, 0.6);
      }

      .helpModal .close {
        position: absolute;
        top: 10px;
        right: 14px;
        background: none;
        border: none;
        color: var(--fg);
        font-size: 22px;
        cursor: pointer;
      }

      /* Flex-based "table" */

      .api-grid-search {
        display: flex;
        flex-direction: column;
        gap: 10px;
        font-size: 13px;
      }

      .api-grid-search > span {
        display: flex;
      }

      .api-grid-search > span > span,
      .api-grid-search > span > ul {
        flex: 1;
      }

      .api-grid-search .header {
        font-weight: 600;
        color: var(--accent);
      }

      .api-grid-search ul {
        padding-left: 16px;
        margin: 0;
      }

      .recs {
        margin-top: 24px;
        font-size: 13px;
        color: var(--muted);
      }

      .recs a {
        color: var(--accent);
      }

      /* ---------------- Blur Feature Flag ---------------- */

      #blurToggle {
        padding: 0 14px;
        height: 32px;
        border-radius: 999px;
        background: var(--card);
        border: 1px solid var(--border);
        color: var(--fg);
        font-size: 12px;
        cursor: pointer;
      }

      #blurToggle.active {
        background: linear-gradient(135deg, var(--accent), #3b7dff);
        color: #02040a;
      }

      /* Feature flag */
      .blur-on .card img {
        filter: blur(6px) saturate(0.9);
        transform: scale(1.05);
      }

      .blur-on .card:hover img {
        filter: blur(0);
      }

      /* Smooth transition */
      .card img {
        transition:
          filter 0.35s ease,
          transform 0.35s ease;
      }

      /* ---------------- Help Modal Content ---------------- */

      .helpModal h2 {
        margin: 0 0 6px;
        font-size: 20px;
      }

      .helpModal .intro {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 20px;
      }

      .helpModal section {
        margin-bottom: 18px;
      }

      .helpModal h3 {
        margin: 0 0 6px;
        font-size: 14px;
        color: var(--accent);
        letter-spacing: 0.3px;
      }

      .helpModal p {
        margin: 0 0 8px;
        font-size: 13px;
        color: var(--fg);
      }

      .helpModal code {
        background: rgba(255, 255, 255, 0.06);
        padding: 2px 6px;
        border-radius: 6px;
        font-size: 12px;
      }

      /* Chips */

      .chips {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        padding: 0;
        margin: 6px 0 0;
        list-style: none;
      }

      .chips li {
        background: var(--card-soft);
        border: 1px solid var(--border);
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      /* Color dots */

      .color-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: var(--c);
        border: 1px solid rgba(255, 255, 255, 0.3);
      }

      /* Footer link */

      .recs {
        margin-top: 24px;
        font-size: 13px;
        color: var(--muted);
      }

      .recs a {
        color: var(--accent);
        text-decoration: none;
      }

      .recs a:hover {
        text-decoration: underline;
      }
    </style>
  </head>

  <body>
    <header>
      <div>
        <span>BIZARRE VIEW</span>
        <svg
          width="32"
          height="32"
          version="1.1"
          id="Layer_1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          x="0px"
          y="0px"
          viewBox="0 0 512 512"
          enable-background="new 0 0 512 512"
          xml:space="preserve"
        >
          <g>
            <linearGradient
              id="SVGID_1_"
              gradientUnits="userSpaceOnUse"
              x1="302.1712"
              y1="128.7627"
              x2="414.2205"
              y2="-4.7723"
            >
              <stop offset="0" style="stop-color: #a9447c" />
              <stop offset="0.3706" style="stop-color: #713068" />
              <stop offset="1" style="stop-color: #0b0c44" />
            </linearGradient>
            <path
              fill="url(#SVGID_1_)"
              stroke="#000000"
              stroke-width="7"
              d="M276.8,107.5c19,5.7,39.7,11.7,51.8,14.1   C361.7,86.1,424,28.5,444,20.3C418.8,12.5,386.6,7.4,365.2,6C341.6,23.5,295.5,68.3,276.8,107.5z"
            />
            <linearGradient
              id="SVGID_2_"
              gradientUnits="userSpaceOnUse"
              x1="382.7103"
              y1="151.2625"
              x2="473.6362"
              y2="42.9013"
            >
              <stop offset="0" style="stop-color: #a9447c" />
              <stop offset="0.3706" style="stop-color: #713068" />
              <stop offset="1" style="stop-color: #0b0c44" />
            </linearGradient>
            <path
              fill="url(#SVGID_2_)"
              stroke="#000000"
              stroke-width="7"
              d="M357.1,126.9c3.4,6,32.2,32.2,40,31.5   c34.2-16.6,89.9-67.8,101-95c-11.4-9.2-27.5-19-38-20.9C434.7,58.1,371.2,108.1,357.1,126.9z"
            />
            <linearGradient
              id="SVGID_3_"
              gradientUnits="userSpaceOnUse"
              x1="35.3239"
              y1="519.665"
              x2="344.0546"
              y2="151.7341"
            >
              <stop offset="0" style="stop-color: #b84882" />
              <stop offset="0.342" style="stop-color: #80356e" />
              <stop offset="1" style="stop-color: #0c0d45" />
            </linearGradient>
            <path
              fill="url(#SVGID_3_)"
              stroke="#000000"
              stroke-width="7"
              d="M52.9,390.3c-14.3,27-50.6,89.2-35.3,114.4   c3.9,6.5,65.1-11.9,131.8-26.9c46.6-10.4,96.4-24.1,125.2-28.1c11.5-1.6,28.5-26.4,29.4-45c1.2-25.3-0.8-147.8,35.6-223.6   c6-10.1,4.1-29.6-2.7-35.4c-8-6.8-20.2-10.5-42.5-3.5c-14.7,4.6-117.8,57-122.8,53.7c-3.2-2.1,9.9-58.8,11.5-70.6   c-26.3,29.1-164.5,180.1-142.6,202c14.8,14.8,153.9-80.5,185.7-75.9c14.9,2.1,16.9,10.4,16.2,21.4c-1.9,13.7-15.6,100.4-18.1,114.1   C167.5,388,79.9,388.9,52.9,390.3z"
            />
          </g>
        </svg>
        <svg
          width="32"
          height="32"
          version="1.1"
          id="Layer_1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          x="0px"
          y="0px"
          viewBox="0 0 512 512"
          enable-background="new 0 0 512 512"
          xml:space="preserve"
        >
          <g>
            <linearGradient
              id="SVGID_1_"
              gradientUnits="userSpaceOnUse"
              x1="302.1712"
              y1="128.7627"
              x2="414.2205"
              y2="-4.7723"
            >
              <stop offset="0" style="stop-color: #a9447c" />
              <stop offset="0.3706" style="stop-color: #713068" />
              <stop offset="1" style="stop-color: #0b0c44" />
            </linearGradient>
            <path
              fill="url(#SVGID_1_)"
              stroke="#000000"
              stroke-width="7"
              d="M276.8,107.5c19,5.7,39.7,11.7,51.8,14.1   C361.7,86.1,424,28.5,444,20.3C418.8,12.5,386.6,7.4,365.2,6C341.6,23.5,295.5,68.3,276.8,107.5z"
            />
            <linearGradient
              id="SVGID_2_"
              gradientUnits="userSpaceOnUse"
              x1="382.7103"
              y1="151.2625"
              x2="473.6362"
              y2="42.9013"
            >
              <stop offset="0" style="stop-color: #a9447c" />
              <stop offset="0.3706" style="stop-color: #713068" />
              <stop offset="1" style="stop-color: #0b0c44" />
            </linearGradient>
            <path
              fill="url(#SVGID_2_)"
              stroke="#000000"
              stroke-width="7"
              d="M357.1,126.9c3.4,6,32.2,32.2,40,31.5   c34.2-16.6,89.9-67.8,101-95c-11.4-9.2-27.5-19-38-20.9C434.7,58.1,371.2,108.1,357.1,126.9z"
            />
            <linearGradient
              id="SVGID_3_"
              gradientUnits="userSpaceOnUse"
              x1="35.3239"
              y1="519.665"
              x2="344.0546"
              y2="151.7341"
            >
              <stop offset="0" style="stop-color: #b84882" />
              <stop offset="0.342" style="stop-color: #80356e" />
              <stop offset="1" style="stop-color: #0c0d45" />
            </linearGradient>
            <path
              fill="url(#SVGID_3_)"
              stroke="#000000"
              stroke-width="7"
              d="M52.9,390.3c-14.3,27-50.6,89.2-35.3,114.4   c3.9,6.5,65.1-11.9,131.8-26.9c46.6-10.4,96.4-24.1,125.2-28.1c11.5-1.6,28.5-26.4,29.4-45c1.2-25.3-0.8-147.8,35.6-223.6   c6-10.1,4.1-29.6-2.7-35.4c-8-6.8-20.2-10.5-42.5-3.5c-14.7,4.6-117.8,57-122.8,53.7c-3.2-2.1,9.9-58.8,11.5-70.6   c-26.3,29.1-164.5,180.1-142.6,202c14.8,14.8,153.9-80.5,185.7-75.9c14.9,2.1,16.9,10.4,16.2,21.4c-1.9,13.7-15.6,100.4-18.1,114.1   C167.5,388,79.9,388.9,52.9,390.3z"
            />
          </g>
        </svg>
        <svg
          width="32"
          height="32"
          version="1.1"
          id="Layer_1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          x="0px"
          y="0px"
          viewBox="0 0 512 512"
          enable-background="new 0 0 512 512"
          xml:space="preserve"
        >
          <g>
            <linearGradient
              id="SVGID_1_"
              gradientUnits="userSpaceOnUse"
              x1="302.1712"
              y1="128.7627"
              x2="414.2205"
              y2="-4.7723"
            >
              <stop offset="0" style="stop-color: #a9447c" />
              <stop offset="0.3706" style="stop-color: #713068" />
              <stop offset="1" style="stop-color: #0b0c44" />
            </linearGradient>
            <path
              fill="url(#SVGID_1_)"
              stroke="#000000"
              stroke-width="7"
              d="M276.8,107.5c19,5.7,39.7,11.7,51.8,14.1   C361.7,86.1,424,28.5,444,20.3C418.8,12.5,386.6,7.4,365.2,6C341.6,23.5,295.5,68.3,276.8,107.5z"
            />
            <linearGradient
              id="SVGID_2_"
              gradientUnits="userSpaceOnUse"
              x1="382.7103"
              y1="151.2625"
              x2="473.6362"
              y2="42.9013"
            >
              <stop offset="0" style="stop-color: #a9447c" />
              <stop offset="0.3706" style="stop-color: #713068" />
              <stop offset="1" style="stop-color: #0b0c44" />
            </linearGradient>
            <path
              fill="url(#SVGID_2_)"
              stroke="#000000"
              stroke-width="7"
              d="M357.1,126.9c3.4,6,32.2,32.2,40,31.5   c34.2-16.6,89.9-67.8,101-95c-11.4-9.2-27.5-19-38-20.9C434.7,58.1,371.2,108.1,357.1,126.9z"
            />
            <linearGradient
              id="SVGID_3_"
              gradientUnits="userSpaceOnUse"
              x1="35.3239"
              y1="519.665"
              x2="344.0546"
              y2="151.7341"
            >
              <stop offset="0" style="stop-color: #b84882" />
              <stop offset="0.342" style="stop-color: #80356e" />
              <stop offset="1" style="stop-color: #0c0d45" />
            </linearGradient>
            <path
              fill="url(#SVGID_3_)"
              stroke="#000000"
              stroke-width="7"
              d="M52.9,390.3c-14.3,27-50.6,89.2-35.3,114.4   c3.9,6.5,65.1-11.9,131.8-26.9c46.6-10.4,96.4-24.1,125.2-28.1c11.5-1.6,28.5-26.4,29.4-45c1.2-25.3-0.8-147.8,35.6-223.6   c6-10.1,4.1-29.6-2.7-35.4c-8-6.8-20.2-10.5-42.5-3.5c-14.7,4.6-117.8,57-122.8,53.7c-3.2-2.1,9.9-58.8,11.5-70.6   c-26.3,29.1-164.5,180.1-142.6,202c14.8,14.8,153.9-80.5,185.7-75.9c14.9,2.1,16.9,10.4,16.2,21.4c-1.9,13.7-15.6,100.4-18.1,114.1   C167.5,388,79.9,388.9,52.9,390.3z"
            />
          </g>
        </svg>
      </div>

      <div style="display: flex; gap: 8px">
        <button id="blurToggle">Blur</button>
        <button id="helpBtn">?</button>
      </div>
    </header>

    <form id="searchForm">
      <input name="q" placeholder="Поиск" />

      <select name="categories">
        <option value="111">Все категории</option>
        <option value="100">Общее</option>
        <option value="010">Аниме</option>
        <option value="001">Люди</option>
      </select>

      <select name="sorting">
        <option selected value="toplist">Toplist</option>
        <option value="date_added">Date added</option>
        <option value="relevance">Relevance</option>
        <option value="views">Views</option>
        <option value="favorites">Favorites</option>
        <option value="random">Random</option>
      </select>

      <select name="topRange">
        <option value="1d">1d</option>
        <option value="3d">3d</option>
        <option value="1w">1w</option>
        <option selected value="1M">1M</option>
        <option value="3M">3M</option>
        <option value="6M">1y</option>
      </select>

      <input name="atleast" placeholder="Минимум (1920x1080)" />

      <select name="colors">
        <option selected value="">Все цвета</option>
        <option value="660000">DkRed</option>
        <option value="990000">Red</option>
        <option value="cc0000">Vivid Red</option>
        <option value="cc3333">Crimson</option>
        <option value="ea4c88">Rose</option>
        <option value="993399">Purple</option>
        <option value="663399">Violet</option>
        <option value="333399">Indigo</option>
        <option value="0066cc">Blue</option>
        <option value="0099cc">Sky Blue</option>
        <option value="66cccc">Turquoise</option>
        <option value="77cc33">Lime</option>
        <option value="669900">Olive</option>
        <option value="336600">DkGreen</option>
        <option value="666600">Drab</option>
        <option value="999900">Moss</option>
        <option value="cccc33">Mustard</option>
        <option value="ffff00">Yellow</option>
        <option value="ffcc33">Gold</option>
        <option value="ff9900">Orange</option>
        <option value="ff6600">Pumpkin</option>
        <option value="cc6633">Rust</option>
        <option value="996633">Tan</option>
        <option value="663300">Brown</option>
        <option value="000000">Black</option>
        <option value="999999">Gray</option>
        <option value="cccccc">LtGray</option>
        <option value="ffffff">White</option>
        <option value="424153">Charcoal</option>
      </select>

      <button type="submit">Поиск</button>
    </form>

    <div id="grid"></div>

    <footer>
      <button id="prev" class="secondary">← Prev</button>
      <span id="pageInfo">Page 1</span>
      <button id="next" class="secondary">Next →</button>
    </footer>

    <div id="helpOverlay">
      <div class="helpModal">
        <button class="close">×</button>

        <h2>Search tips</h2>
        <p class="intro">
          Fine-tune results using tags, filters and sorting. Most fields are
          optional.
        </p>

        <section>
          <h3>Query</h3>
          <p>Use keywords or tags to describe what you want.</p>
          <ul class="chips">
            <li><code>tag</code></li>
            <li><code>-exclude</code></li>
            <li><code>+required</code></li>
            <li><code>@user</code></li>
          </ul>
        </section>

        <section>
          <h3>Sorting</h3>
          <p><code>Toplist</code> works best with a time range.</p>
        </section>

        <section>
          <h3>Quality filters</h3>
          <p>Limit results by minimum resolution or dominant color.</p>
          <ul class="chips">
            <li><code>1920x1080</code></li>
            <li><span class="color-dot" style="--c: #0099cc"></span> Blue</li>
            <li><span class="color-dot" style="--c: #77cc33"></span> Lime</li>
            <li><span class="color-dot" style="--c: #ffffff"></span> White</li>
          </ul>
        </section>

        <section>
          <h3>Navigation</h3>
          <p>Use <b>Prev</b> / <b>Next</b> to move between pages.</p>
        </section>

        <div class="recs">
          <span>
            Extra inspiration →
            <a
              href="https://github.com/the-speedwagon-foundation/humanitarian-cargo/archive/refs/heads/main.zip"
              target="_blank"
            >
              Foundation recommendations
            </a>
          </span>
        </div>
      </div>
    </div>

    <script>
      const API = "https://wallhaven.cc/api/v1/search";
      let currentPage = 1;
      let lastPage = 1;

      const form = document.getElementById("searchForm");
      const grid = document.getElementById("grid");
      const pageInfo = document.getElementById("pageInfo");
      const helpBtn = document.getElementById("helpBtn");
      const helpOverlay = document.getElementById("helpOverlay");

      async function fetchWallpapers(page = 1) {
        const data = new FormData(form);
        const params = new URLSearchParams();

        const colorsValue = data.get("colors");
        if (colorsValue === "") {
          data.delete("colors");
        }

        for (const [key, value] of data.entries()) {
          params.append(key, value);
        }

        params.append("purity", "SFW");
        params.append("page", page);

        const res = await fetch(
          `https://proxy.vmlabs.su:3128/?url=${API}?${params}`,
        );
        const json = await res.json();

        grid.innerHTML = "";
        json.data.forEach((w) => {
          const card = document.createElement("div");
          card.className = "card";
          card.innerHTML = `
      <img src="https://proxy.vmlabs.su:3128/?url=${w.thumbs.small}" alt="">
      <div class="info">
        <span>${w.resolution}</span>
        <a href="https://proxy.vmlabs.su:3128/?url=${w.path}" download>${w.path.split("-")[1]}</a>
      </div>
    `;
          grid.appendChild(card);
        });

        currentPage = json.meta.current_page;
        lastPage = json.meta.last_page;
        pageInfo.textContent = `Page ${currentPage} / ${lastPage}`;
      }

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        fetchWallpapers(1);
      });

      document.getElementById("prev").onclick = () => {
        if (currentPage > 1) fetchWallpapers(currentPage - 1);
      };

      document.getElementById("next").onclick = () => {
        if (currentPage < lastPage) fetchWallpapers(currentPage + 1);
      };

      helpBtn.onclick = () => (helpOverlay.style.display = "flex");
      helpOverlay.onclick = (e) => {
        if (e.target === helpOverlay || e.target.classList.contains("close")) {
          helpOverlay.style.display = "none";
        }
      };

      const blurToggle = document.getElementById("blurToggle");
      let blurEnabled = false;

      blurToggle.onclick = () => {
        blurEnabled = !blurEnabled;
        document.body.classList.toggle("blur-on", blurEnabled);
        blurToggle.classList.toggle("active", blurEnabled);
      };

      blurEnabled = localStorage.getItem("blur") === "1";
      document.body.classList.toggle("blur-on", blurEnabled);
      blurToggle.classList.toggle("active", blurEnabled);

      blurToggle.onclick = () => {
        blurEnabled = !blurEnabled;
        localStorage.setItem("blur", blurEnabled ? "1" : "0");
        document.body.classList.toggle("blur-on", blurEnabled);
        blurToggle.classList.toggle("active", blurEnabled);
      };

      fetchWallpapers();
    </script>
  </body>
</html>
